<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>幾A幾B遊戲</title>
<link rel="stylesheet" href="1a2b_style.css">
</head>
<body>
<div class="container">
    <h1>幾A幾B遊戲</h1>
    <p id="message" style="text-align:center; font-weight:bold;">遊戲開始，請輸入數字！</p>
    <form id="gameForm">
        <input type="text" id="guessInput" maxlength="4" placeholder="輸入 4 位不重複數字" required>
        <div class="btns">
            <button type="submit" id="submitBtn">送出</button>
            <button type="button" id="resetBtn">重新開始</button>
        </div>
    </form>

    <h2>歷史紀錄</h2>
    <ul id="history"></ul>
</div>

<script>
// 遊戲邏輯
let answer = generateAnswer();
let history = [];

const form = document.getElementById('gameForm');
const messageEl = document.getElementById('message');
const historyEl = document.getElementById('history');
const guessInput = document.getElementById('guessInput');
const resetBtn = document.getElementById('resetBtn');

function generateAnswer() {
    let digits = [];
    while(digits.length < 4){
        let d = Math.floor(Math.random()*10);
        if(!digits.includes(d)) digits.push(d);
    }
    return digits.join('');
}

function checkGuess(guess, answer){
    let A=0,B=0;
    for(let i=0;i<4;i++){
        if(guess[i] === answer[i]) A++;
        else if(answer.includes(guess[i])) B++;
    }
    return `${A}A${B}B`;
}

function updateHistory(){
    historyEl.innerHTML = '';
    history.slice().reverse().forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        historyEl.appendChild(li);
    });
}

form.addEventListener('submit', function(e){
    e.preventDefault();
    const guess = guessInput.value.trim();
    if(!/^\d{4}$/.test(guess)){
        alert("請輸入 4 位數字！");
        return;
    }
    if(new Set(guess).size !== 4){
        alert("數字不能重複！");
        return;
    }
    const result = checkGuess(guess, answer);
    history.push(`${guess} → ${result}`);
    updateHistory();
    messageEl.textContent = (result === "4A0B") ? `🎉 恭喜答對！答案是 ${answer}` : result;
    guessInput.value = '';
});

resetBtn.addEventListener('click', function(){
    answer = generateAnswer();
    history = [];
    messageEl.textContent = "新遊戲開始，請輸入數字！";
    updateHistory();
    guessInput.value = '';
});
</script>
</body>
</html>
